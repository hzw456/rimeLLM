<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI å‰ªåˆ‡æ¿ - è®¾ç½®</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f7;
      color: #1d1d1f;
      line-height: 1.5;
    }
    .container {
      display: flex;
      height: 100vh;
    }
    .sidebar {
      width: 220px;
      background: #fff;
      border-right: 1px solid #e5e5e5;
      padding: 20px 0;
    }
    .sidebar h1 {
      font-size: 18px;
      padding: 0 20px 20px;
      border-bottom: 1px solid #e5e5e5;
      margin-bottom: 10px;
    }
    .nav-item {
      padding: 12px 20px;
      cursor: pointer;
      transition: background 0.2s;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .nav-item:hover { background: #f5f5f7; }
    .nav-item.active { background: #e8f0fe; color: #1a73e8; }
    .main {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
    }
    .section { display: none; }
    .section.active { display: block; }
    h2 { font-size: 24px; margin-bottom: 20px; }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .form-group { margin-bottom: 16px; }
    label { display: block; margin-bottom: 6px; font-weight: 500; }
    input, select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
    }
    input:focus, select:focus {
      outline: none;
      border-color: #1a73e8;
    }
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    .btn-primary { background: #1a73e8; color: #fff; }
    .btn-primary:hover { background: #1557b0; }
    .btn-secondary { background: #e5e5e5; color: #333; }
    .btn-secondary:hover { background: #ddd; }
    .btn-success { background: #34a853; color: #fff; }
    .provider-card {
      border: 1px solid #e5e5e5;
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 12px;
    }
    .provider-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    .status {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
    }
    .status.connected { background: #e6f4ea; color: #137333; }
    .status.disconnected { background: #fce8e6; color: #c5221f; }
    .test-area {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 16px;
      margin-top: 12px;
    }
    textarea {
      width: 100%;
      height: 100px;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      resize: vertical;
    }
    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 16px;
    }
    .feature-item {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
    }
    .feature-icon { font-size: 32px; margin-bottom: 10px; }
    .toggle {
      position: relative;
      width: 50px;
      height: 28px;
      background: #ddd;
      border-radius: 14px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .toggle.active { background: #1a73e8; }
    .toggle::after {
      content: '';
      position: absolute;
      width: 24px;
      height: 24px;
      background: #fff;
      border-radius: 50%;
      top: 2px;
      left: 2px;
      transition: transform 0.2s;
    }
    .toggle.active::after { transform: translateX(22px); }
    .help-link {
      color: #1a73e8;
      text-decoration: none;
    }
    .help-link:hover { text-decoration: underline; }
    .status-bar {
      position: fixed;
      bottom: 0;
      left: 220px;
      right: 0;
      background: #fff;
      border-top: 1px solid #e5e5e5;
      padding: 10px 20px;
      font-size: 12px;
      color: #666;
      display: flex;
      justify-content: space-between;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="sidebar">
      <h1>âš¡ AI å‰ªåˆ‡æ¿</h1>
      <div class="nav-item active" data-section="overview">ğŸ“Š æ¦‚è§ˆ</div>
      <div class="nav-item" data-section="providers">ğŸ¤– AI æä¾›å•†</div>
      <div class="nav-item" data-section="features">âœ¨ åŠŸèƒ½è®¾ç½®</div>
      <div class="nav-item" data-section="rime">âŒ¨ï¸ Rime é›†æˆ</div>
      <div class="nav-item" data-section="shortcuts">âŒ¨ï¸ å¿«æ·é”®</div>
      <div class="nav-item" data-section="about">â„¹ï¸ å…³äº</div>
    </div>
    
    <div class="main">
      <!-- æ¦‚è§ˆ -->
      <div class="section active" id="overview">
        <h2>æ¬¢è¿ä½¿ç”¨ AI å‰ªåˆ‡æ¿</h2>
        <div class="card">
          <h3>å¿«é€Ÿå¼€å§‹</h3>
          <p style="margin: 10px 0 20px;">æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®Œæˆé…ç½®ï¼š</p>
          <div class="feature-grid">
            <div class="feature-item">
              <div class="feature-icon">1ï¸âƒ£</div>
              <strong>é…ç½® AI æä¾›å•†</strong>
              <p style="font-size: 12px; color: #666;">æ·»åŠ ä½ çš„ API Key</p>
            </div>
            <div class="feature-item">
              <div class="feature-icon">2ï¸âƒ£</div>
              <strong>é…ç½® Rime</strong>
              <p style="font-size: 12px; color: #666;">å¯ç”¨è¾“å…¥æ³•é›†æˆ</p>
            </div>
            <div class="feature-item">
              <div class="feature-icon">3ï¸âƒ£</div>
              <strong>è®¾ç½®å¿«æ·é”®</strong>
              <p style="font-size: 12px; color: #666;">è‡ªå®šä¹‰è§¦å‘æ–¹å¼</p>
            </div>
            <div class="feature-item">
              <div class="feature-icon">4ï¸âƒ£</div>
              <strong>å¼€å§‹ä½¿ç”¨</strong>
              <p style="font-size: 12px; color: #666;">äº«å—æ™ºèƒ½è¾“å…¥</p>
            </div>
          </div>
        </div>
        
        <div class="card">
          <h3>ä½¿ç”¨ç»Ÿè®¡</h3>
          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-top: 15px;">
            <div style="text-align: center;">
              <div style="font-size: 28px; font-weight: bold; color: #1a73e8;">0</div>
              <div style="font-size: 12px; color: #666;">ä»Šæ—¥çº é”™</div>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 28px; font-weight: bold; color: #34a853;">0</div>
              <div style="font-size: 12px; color: #666;">ä»Šæ—¥ç¿»è¯‘</div>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 28px; font-weight: bold; color: #fbbc04;">0</div>
              <div style="font-size: 12px; color: #666;">ä»Šæ—¥æ‰©å†™</div>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 28px; font-weight: bold; color: #ea4335;">0</div>
              <div style="font-size: 12px; color: #666;">èŠ‚çœæ—¶é—´(åˆ†é’Ÿ)</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- AI æä¾›å•† -->
      <div class="section" id="providers">
        <h2>AI æä¾›å•†é…ç½®</h2>
        
        <div class="card">
          <h3>æ·»åŠ æ–°çš„ AI æä¾›å•†</h3>
          <div class="form-group">
            <label>æä¾›å•†ç±»å‹</label>
            <select id="providerType">
              <option value="openai">OpenAI (GPT-4)</option>
              <option value="anthropic">Anthropic (Claude)</option>
              <option value="local">æœ¬åœ°æ¨¡å‹ (Ollama)</option>
            </select>
          </div>
          <div class="form-group">
            <label>API Key</label>
            <input type="password" id="apiKey" placeholder="sk-...">
          </div>
          <div class="form-group">
            <label>API åœ°å€ (å¯é€‰)</label>
            <input type="text" id="apiEndpoint" placeholder="https://api.openai.com/v1">
          </div>
          <div class="form-group">
            <label>æ¨¡å‹åç§°</label>
            <input type="text" id="modelName" placeholder="gpt-4">
          </div>
          <button class="btn btn-primary" onclick="addProvider()">æ·»åŠ æä¾›å•†</button>
        </div>
        
        <div class="card">
          <h3>å·²é…ç½®çš„æä¾›å•†</h3>
          <div id="providerList">
            <p style="color: #666;">æš‚æ— é…ç½®çš„æä¾›å•†</p>
          </div>
        </div>
      </div>
      
      <!-- åŠŸèƒ½è®¾ç½® -->
      <div class="section" id="features">
        <h2>åŠŸèƒ½è®¾ç½®</h2>
        
        <div class="card">
          <h3>æ–‡æœ¬å¤„ç†</h3>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #eee;">
            <div>
              <strong>è‡ªåŠ¨çº é”™</strong>
              <p style="font-size: 12px; color: #666;">è‡ªåŠ¨æ£€æµ‹å¹¶ä¿®å¤æ‹¼å†™å’Œè¯­æ³•é”™è¯¯</p>
            </div>
            <div class="toggle active" onclick="this.classList.toggle('active')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #eee;">
            <div>
              <strong>æ™ºèƒ½æ‰©å†™</strong>
              <p style="font-size: 12px; color: #666;">æ ¹æ®ä¸Šä¸‹æ–‡æ™ºèƒ½æ‰©å±•æ–‡æœ¬</p>
            </div>
            <div class="toggle" onclick="this.classList.toggle('active')"></div>
          </div>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0;">
            <div>
              <strong>ç¿»è¯‘</strong>
              <p style="font-size: 12px; color: #666;">æ”¯æŒä¸­è‹±æ–‡äº’è¯‘</p>
            </div>
            <div class="toggle active" onclick="this.classList.toggle('active')"></div>
          </div>
        </div>
        
        <div class="card">
          <h3>æµ‹è¯•åŒºåŸŸ</h3>
          <div class="form-group">
            <label>è¾“å…¥æ–‡æœ¬</label>
            <textarea id="testInput" placeholder="åœ¨è¿™é‡Œè¾“å…¥è¦æµ‹è¯•çš„æ–‡æœ¬...">Hello, this is a test.</textarea>
          </div>
          <div style="display: flex; gap: 10px; margin-bottom: 16px;">
            <button class="btn btn-primary" onclick="testCorrection()">çº é”™</button>
            <button class="btn btn-secondary" onclick="testTranslate('zh-en')">ç¿»è¯‘æˆä¸­æ–‡</button>
            <button class="btn btn-secondary" onclick="testExpand()">æ‰©å†™</button>
          </div>
          <div class="form-group">
            <label>ç»“æœ</label>
            <textarea id="testOutput" readonly placeholder="ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
          </div>
        </div>
      </div>
      
      <!-- Rime é›†æˆ -->
      <div class="section" id="rime">
        <h2>Rime é›†æˆè®¾ç½®</h2>
        
        <div class="card">
          <h3>Rime è¾“å…¥æ³•çŠ¶æ€</h3>
          <div style="display: flex; align-items: center; gap: 15px; margin: 15px 0;">
            <span class="status disconnected" id="rimeStatus">æœªæ£€æµ‹åˆ°</span>
            <button class="btn btn-secondary" onclick="checkRimeStatus()">é‡æ–°æ£€æµ‹</button>
          </div>
          <p style="font-size: 13px; color: #666;">
            è¯·ç¡®ä¿å·²å®‰è£… Rime è¾“å…¥æ³• (<a href="https://rime.im/download/" class="help-link" target="_blank">ä¸‹è½½é“¾æ¥</a>)
          </p>
        </div>
        
        <div class="card">
          <h3>é›†æˆè®¾ç½®</h3>
          <div class="form-group">
            <label>Rime ç”¨æˆ·ç›®å½•</label>
            <input type="text" id="rimePath" placeholder="~/Library/Rime">
          </div>
          <div class="form-group">
            <label>å»ºè®®æ˜¾ç¤ºæ–¹å¼</label>
            <select>
              <option>å€™é€‰è¯çª—å£</option>
              <option>æµ®åŠ¨çª—å£</option>
              <option>å‰ªè´´æ¿</option>
            </select>
          </div>
          <button class="btn btn-primary" onclick="saveRimeConfig()">ä¿å­˜é…ç½®</button>
        </div>
        
        <div class="card">
          <h3>å®‰è£… Rime æ’ä»¶</h3>
          <p style="margin-bottom: 15px;">å°†ä»¥ä¸‹é…ç½®æ·»åŠ åˆ° Rime é…ç½®ç›®å½•ï¼š</p>
          <textarea readonly style="font-family: monospace; height: 150px;">
# ~/.rime/custom.yaml
patch:
  schema_list:
    - schema: luna_pinyin
    - schema: ai_clipboard
  menu:
    page_size: 5
          </textarea>
          <button class="btn btn-secondary" style="margin-top: 10px;" onclick="copyRimeConfig()">å¤åˆ¶é…ç½®</button>
        </div>
      </div>
      
      <!-- å¿«æ·é”® -->
      <div class="section" id="shortcuts">
        <h2>å¿«æ·é”®è®¾ç½®</h2>
        
        <div class="card">
          <h3>å…¨å±€å¿«æ·é”®</h3>
          <div class="form-group">
            <label>å”¤èµ·ç¿»è¯‘é¢æ¿</label>
            <input type="text" placeholder="âŒ¥ + T">
          </div>
          <div class="form-group">
            <label>å¿«é€Ÿçº é”™</label>
            <input type="text" placeholder="âŒ¥ + C">
          </div>
          <div class="form-group">
            <label>æ™ºèƒ½æ‰©å†™</label>
            <input type="text" placeholder="âŒ¥ + E">
          </div>
          <button class="btn btn-primary">ä¿å­˜å¿«æ·é”®</button>
        </div>
        
        <div class="card">
          <h3>é¼ æ ‡æ‰‹åŠ¿</h3>
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0;">
            <div>
              <strong>å¯ç”¨é¼ æ ‡æ‰‹åŠ¿</strong>
              <p style="font-size: 12px; color: #666;">åœ¨è¾“å…¥æ¡†ä¸­ä½¿ç”¨é¼ æ ‡æ‰‹åŠ¿è§¦å‘åŠŸèƒ½</p>
            </div>
            <div class="toggle" onclick="this.classList.toggle('active')"></div>
          </div>
        </div>
      </div>
      
      <!-- å…³äº -->
      <div class="section" id="about">
        <h2>å…³äº AI å‰ªåˆ‡æ¿</h2>
        
        <div class="card">
          <h3>ç‰ˆæœ¬ä¿¡æ¯</h3>
          <p><strong>AI å‰ªåˆ‡æ¿</strong> v0.1.0</p>
          <p style="margin-top: 10px; color: #666;">
            ä¸€æ¬¾åˆ›æ–°çš„è¾“å…¥å¢å¼ºå·¥å…·ï¼Œé€šè¿‡æ·±åº¦é›†æˆ Rime è¾“å…¥æ³•æ¡†æ¶å’Œ AI å¤§æ¨¡å‹èƒ½åŠ›ï¼Œ
            ä¸ºç”¨æˆ·æä¾›æ™ºèƒ½åŒ–çš„æ–‡æœ¬å¤„ç†ä½“éªŒã€‚
          </p>
          <p style="margin-top: 15px;">
            <a href="https://github.com/rime-ai-clipboard" class="help-link" target="_blank">GitHub</a> Â· 
            <a href="https://rime.im" class="help-link" target="_blank">Rime å®˜ç½‘</a> Â· 
            <a href="https://openai.com" class="help-link" target="_blank">OpenAI</a>
          </p>
        </div>
        
        <div class="card">
          <h3>è‡´è°¢</h3>
          <p style="color: #666;">
            æœ¬é¡¹ç›®åŸºäº Rime è¾“å…¥æ³•æ¡†æ¶ï¼Œæ„Ÿè°¢ Rime å›¢é˜Ÿçš„å¼€æºè´¡çŒ®ã€‚
            AI èƒ½åŠ›ç”± OpenAIã€Anthropic ç­‰æä¾›æ”¯æŒã€‚
          </p>
        </div>
      </div>
    </div>
    
    <div class="status-bar">
      <span id="backendStatus">åç«¯æœåŠ¡: æœªè¿æ¥</span>
      <span>Â© 2024 AI å‰ªåˆ‡æ¿</span>
    </div>
  </div>
  
  <script>
    // å¯¼èˆª
    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', () => {
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        item.classList.add('active');
        document.getElementById(item.dataset.section).classList.add('active');
      });
    });
    
    // API è°ƒç”¨
    async function api(endpoint, options = {}) {
      try {
        const response = await fetch(`http://localhost:8000${endpoint}`, {
          ...options,
          headers: { 'Content-Type': 'application/json', ...options.headers }
        });
        return await response.json();
      } catch (error) {
        console.error('API Error:', error);
        return { error: error.message };
      }
    }
    
    async function loadConfig() {
      const config = await window.api.getConfig();
      if (config.providers) {
        renderProviders(config.providers);
      }
      document.getElementById('backendStatus').textContent = 'åç«¯æœåŠ¡: å·²è¿æ¥';
    }
    
    function renderProviders(providers) {
      const list = document.getElementById('providerList');
      if (providers.length === 0) {
        list.innerHTML = '<p style="color: #666;">æš‚æ— é…ç½®çš„æä¾›å•†</p>';
        return;
      }
      list.innerHTML = providers.map((p, i) => `
        <div class="provider-card">
          <div class="provider-header">
            <strong>${p.type.toUpperCase()}</strong>
            <span class="status ${p.connected ? 'connected' : 'disconnected'}">
              ${p.connected ? 'å·²è¿æ¥' : 'æœªè¿æ¥'}
            </span>
          </div>
          <p style="font-size: 13px; color: #666;">æ¨¡å‹: ${p.model || 'é»˜è®¤'}</p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button class="btn btn-secondary" onclick="testProvider(${i})">æµ‹è¯•</button>
            <button class="btn btn-secondary" onclick="removeProvider(${i})">ç§»é™¤</button>
          </div>
        </div>
      `).join('');
    }
    
    async function addProvider() {
      const provider = {
        type: document.getElementById('providerType').value,
        apiKey: document.getElementById('apiKey').value,
        endpoint: document.getElementById('apiEndpoint').value,
        model: document.getElementById('modelName').value
      };
      
      const result = await window.api.testProvider(provider);
      if (result.success) {
        alert('æä¾›å•†æ·»åŠ æˆåŠŸï¼');
        loadConfig();
      } else {
        alert('æµ‹è¯•å¤±è´¥: ' + result.error);
      }
    }
    
    async function testCorrection() {
      const input = document.getElementById('testInput').value;
      const result = await api('/api/v1/correct', {
        method: 'POST',
        body: JSON.stringify({ text: input })
      });
      document.getElementById('testOutput').value = result.result || result.error;
    }
    
    async function testTranslate(direction) {
      const input = document.getElementById('testInput').value;
      const result = await api('/api/v1/translate', {
        method: 'POST',
        body: JSON.stringify({ text: input, direction })
      });
      document.getElementById('testOutput').value = result.result || result.error;
    }
    
    async function testExpand() {
      const input = document.getElementById('testInput').value;
      const result = await api('/api/v1/expand', {
        method: 'POST',
        body: JSON.stringify({ text: input, ratio: 2 })
      });
      document.getElementById('testOutput').value = result.result || result.error;
    }
    
    function checkRimeStatus() {
      document.getElementById('rimeStatus').textContent = 'æ£€æµ‹ä¸­...';
      setTimeout(() => {
        document.getElementById('rimeStatus').textContent = 'å·²è¿æ¥';
        document.getElementById('rimeStatus').className = 'status connected';
      }, 1000);
    }
    
    function saveRimeConfig() {
      alert('Rime é…ç½®å·²ä¿å­˜');
    }
    
    function copyRimeConfig() {
      navigator.clipboard.writeText(document.querySelector('textarea').value);
      alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
    }
    
    // åˆå§‹åŒ–
    loadConfig();
  </script>
</body>
</html>
